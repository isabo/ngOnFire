angular.module("ngOnFire",[]);(function(){function f(f,g){function k(a,c){var b;this.$$model_=b=a instanceof onfire.model.Model?a:new a(c);b.onValueChanged(function(){f.$evalAsync(function(){})})}function e(a,c){var b;this.$$model_=b=a instanceof onfire.model.Collection?a:new a(c);b.onChildAdded(n.bind(this));b.onChildRemoved(h.bind(this));this.$$isLoaded_=!1;var d=this;this.$$loadPromise_=b.whenLoaded().then(function(a){return a.forEach(function(b){b instanceof onfire.model.Model?d[b.key()]=r(a):d[b.key()]=b})}).then(function(){d.$$isLoaded_=
!0;t.call(d);return d})}function v(a){var c=this.$$model_;if(!this.$$isLoaded_)throw Error(onfire.model.Error.NOT_LOADED);if(!c.containsKey(a))throw Error(onfire.model.Error.NO_SUCH_KEY);return this[a]}function n(a){var c=this;return this.$$model_.fetch(a).then(function(b){c[a]=b instanceof onfire.model.Model?r(b):b;t.call(c)})}function h(a,c){var b=this[a];b&&(delete this[a],(b instanceof k||b instanceof e)&&b.$dispose(),c||t.call(this))}function t(){f.$evalAsync(function(){})}function r(a){return a instanceof
onfire.model.Collection?new e(a):new k(a)}function x(a){function c(b){k.call(this,a,b)}w(c,k);return c}function y(a){function c(b){e.call(this,a,b)}w(c,e);return c}function z(a,c){Object.defineProperty(a.prototype,c,{get:function(){return this.$$model_[c].call(this.$$model_)},set:function(a){this.$$model_[c].call(this.$$model_,a)},enumerable:!0})}function u(a){return function(){var c=Array.prototype.slice.apply(arguments);c.unshift(this,a);return A.apply(null,c)}}function A(a,c,b){var d=a.$$model_,
e=d[c].apply(d,Array.prototype.slice.call(arguments,2));return e&&"function"===typeof e.then?(e=e.then(function(b){return b===d?a:b}),g.when(e)):e===d?a:e}k.prototype.$dispose=function(){this.$$model_.dispose();this.$$model_=null};var l="whenLoaded key exists hasChanges set save".split(" "),p;for(p in l){var m=l[p];k.prototype["$"+m]=u(m)}e.prototype.$get=v;e.prototype.$create=function(a){var c=this;return this.$$model_.create(a).then(function(a){var d=a.key();return d in c?(a.dispose(),v.call(c,
d)):r(a).$whenLoaded()})};e.prototype.forEach=function(a){var c=[];this.$$model_.keys().map(function(b){(b=a.call(null,self[b],b))&&"function"===typeof b.then&&c.push(g.when(b))});return g.all(c)};e.prototype.$whenLoaded=function(){return g.when(this.$$loadPromise_)};e.prototype.$dispose=function(){for(var a=this.$$model_,c=a.keys(),b=0;b<c.length;b++)h.call(this,c[b],!0);a.dispose();this.$$model_=null};l="key exists hasChanges save set remove count containsKey keys".split(" ");for(p in l)m=l[p],
e.prototype["$"+m]=u(m);return function(a){var c=a.prototype instanceof onfire.model.Collection?y(a):x(a),b=a.getSchema(),d;for(d in a.prototype)a.prototype.hasOwnProperty(d)&&"function"===typeof a.prototype[d]&&(d in b?z(c,d):"Ctor_"!==d.slice(-5)&&(c.prototype["$"+d]=u(d)));return c}}angular.module("ngOnFire").factory("$Model",f);f.$inject=["$rootScope","$q"]})();function w(f,q){function g(){}g.prototype=q.prototype;f.b=q.prototype;f.prototype=new g;f.prototype.constructor=f;f.a=function(f,e,g){for(var n=Array(arguments.length-2),h=2;h<arguments.length;h++)n[h-2]=arguments[h];return q.prototype[e].apply(f,n)}};
